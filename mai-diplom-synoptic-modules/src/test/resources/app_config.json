{
  "description"   : "Настройка модуля для работы из Json файла, где каждый объект на отдельной строке. Используются следующие модули: Оптимист, Пессимист, Синоптик, Математик. Данные выводяться на консоль",
  "modules"       : {
    "JsonDataSource" : {
      "settings" : {
        "sourceFile" : "test_data.json"
      }
    },
    "Optimist"       : {
      "settings" : {
        "answers" : [ "Отличная погодка", "Завтра будет лучше чем вчера", "У природы нет плохой погоды" ]
      }
    },
    "Pessimist"      : {
      "settings" : {
        "answers" : [ "Завтра можно не просыпаться", "Мама, роди меня обратно", "Хорошего не жди" ]
      }
    },
    "Mathematician"  : { },
    "Synoptic"       : {
      "settings" : {
        "answers" : [ "Как вчера", "Туманно", "Ясно как всегда", "Погода перменчивая" ]
      }
    },
    "taskManager"    : {
      "settings" : {
        "dependencies" : {
          "Optimist"       : {
            "input"    : {
              "from" : "JsonDataSource"
            },
            "priority" : 0.1
          },
          "Pessimist"      : {
            "input"    : {
              "from" : "JsonDataSource"
            },
            "priority" : 0.1
          },
          "Mathematician"  : {
            "input"    : {
              "from" : "JsonDataSource"
            },
            "priority" : 0.1
          },
          "Synoptic"       : {
            "input"    : {
              "from" : "JsonDataSource"
            },
            "priority" : 0.1
          },
          "SolutionModule" : {
            "input" : {
              "allOf" : [ "Optimist", "Pessimist", "Mathematician", "Synoptic" ]
            }
          }
        }
      }
    },
    "SolutionModule" : {
      "settings" : {
        "weights"       : {
          "Optimist"      : 0.25,
          "Pessimist"     : 0.25,
          "Mathematician" : 0.4,
          "Synoptic"      : 0.1
        },
        "inputScheme"   : {
          "title" : ""
        },
        "dataFlowGraph" : {
          "broadCast" : {
            "producer"  : "JsonDataSource",
            "consumers" : [ "Optimist", "Pessimist", "Synoptic", "Mathematician" ]
          },
          "bundle"    : {
            "producers"  : [ "Optimist", "Pessimist", "Synoptic", "Mathematician" ],
            "consumer"   : "SolutionModule",
            "bundleSize" : 1
          }
        }
      }
    }
  },
  "dataListeners" : {
    "id"       : "console",
    "listerTo" : [
      "SolutionModule",
      "Optimist",
      "Pessimist",
      "Mathematician",
      "Synoptic"
    ]
  },
  "mappers"       : [
    {
      "description" : "Convert input data to application format",
      "producers"   : [ "JsonDataSource" ],
      "consumers"   : [ "Optimist", "Pessimist", "Mathematician", "Synoptic" ],
      "filters"     : [
        {
          "name"   : "equals",
          "fields" : [
            { "field" : "city.country", "value" : "RU" },
            { "field" : "city.name", "value" : "Moscow" }
          ]
        }
      ],
      "transfers"   : {
        "template" : {
          "id" : "raw"
        },
        "mappings" : [
          {
            "from" : "main.humidity",
            "to"   : "humidity"
          }, {
            "from" : "main.pressure",
            "to"   : "pressure"
          }, {
            "from" : "main.temp",
            "to"   : "temp"
          }, {
            "from" : "wind.deg",
            "to"   : "wind.deg"
          }, {
            "from" : "wind.speed",
            "to"   : "wind.speed"
          }, {
            "from" : "clouds.all",
            "to"   : "clouds"
          },
          {
            "from" : "time",
            "to"   : "time"
          }
        ]
      }
    },
    {
      "description" : "Convert simple modules data to solution format",
      "producers"   : [ "Optimist", "Pessimist", "Synoptic" ],
      "consumers"   : [ "SolutionModule" ],
      "converters"  : [
        {
          "sourcePath"      : "answer",
          "targetPath"      : "value",
          "matcherId"       : "complex",
          "matcherSettings" : [
            {
              "name"       : "equals",
              "template"   : "Завтра можно не просыпаться",
              "matchValue" : 1
            },
            {
              "name"       : "equals",
              "template"   : "Мама, роди меня обратно",
              "matchValue" : 2
            },
            {
              "name"       : "equals",
              "template"   : "Хорошего не жди",
              "matchValue" : 3
            },
            {
              "name"       : "equals",
              "template"   : "Отличная погодка",
              "matchValue" : 1
            },
            {
              "name"       : "equals",
              "template"   : "У природы нет плохой погоды",
              "matchValue" : 2
            },
            {
              "name"       : "equals",
              "template"   : "Завтра будет лучше чем вчера",
              "matchValue" : 3
            },
            {
              "name"       : "equals",
              "template"   : "Как вчера",
              "matchValue" : 1
            },
            {
              "name"       : "equals",
              "template"   : "Туманно",
              "matchValue" : 2
            },
            {
              "name"       : "equals",
              "template"   : "Ясно как всегда",
              "matchValue" : 3
            },
            {
              "name"       : "equals",
              "template"   : "Погода перменчивая",
              "matchValue" : 4
            }
          ]
        }
      ]
    },
    {
      "description" : "Convert Mathematician module data to solution format",
      "producers"   : [ "Optimist", "Pessimist", "Synoptic" ],
      "consumers"   : [ "SolutionModule" ],
      "converters"  : [
        {
          "sourcePath"      : "answer",
          "targetPath"      : "value",
          "matcherId"       : "complex",
          "matcherSettings" : [
            {
              "name"       : "lessThen",
              "matchValue" : 1,
              "template"   : 33.33
            },
            {
              "name"       : "between",
              "matchValue" : 2,
              "from"       : 33.330,
              "to"         : 66.66
            },
            {
              "name"       : "greatThen",
              "matchValue" : 3,
              "template"   : 66.660
            }
          ]
        }
      ]
    }
  ]
}